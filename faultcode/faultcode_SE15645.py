import data.efficiency_function as turbine_efficiency_function
from scipy import signal

def filter1(Df_all, Df_all_m):
    #Df_all['wdir'] = Df_all['wdir'].fillna(method='ffill')
    Df_all['wdir0'] = Df_all['wdir']
    #Df_all['wdir0'] = Df_all['wdir'] - Df_all['yaw']
    Df_all['wdir0'] = Df_all['wdir0'].fillna(0)
    #Df_all['wdir0'] = Df_all['wdir']
    Df_all['wdir0'] = turbine_efficiency_function.pass_filter(Df_all['wdir0'],0.2,5,11,0.5,1,1)#1:低通滤波器，2：中值滤波，3：wiener滤波，4：巴特沃斯滤波器
    Df_all_m['wdir0','nanmean'] = Df_all_m['wdir','nanmean']
    #Df_all_m['wdir0','nanmean'] = Df_all_m['wdir','nanmean'] - Df_all_m['yaw','nanmean']
    return Df_all, Df_all_m

def filter2(Df_all, Df_all_m, medfilt_num, filter1st_tao, choose_num):
    if((['wdir0'] in Df_all.columns.values)==False):
        Df_all['wdir0'] = Df_all['wdir'] - Df_all['yaw']
        Df_all['wdir0'] = Df_all['wdir0'].fillna(0)
    else:
        Df_all['wdir0'] = Df_all['wdir0'].fillna(0)
        
    Df_all['wdir0'] = turbine_efficiency_function.pass_filter(Df_all['wdirs'],filter1st_tao,medfilt_num,11,0.1,1,choose_num)
    
    return Df_all, Df_all_m

import pandas as pd
import numpy as np
#故障码
fnum = pd.Series([
    1024, 3200, 1536, 2, 1792, 24, 4, 3232, 112, 65, 4112, 5, 3588, 48, 3, 7, 13, 21, 22, 23, 31, 35, 37, 40, 46, 47, 54, 56, 57, 59, 92, 95, 102, 110, 111, 113, 114, 115, 116, 117, 120, 121, 122, 123, 134, 137, 138, 140, 142, 144, 146, 148, 150, 153, 156, 158, 159, 167, 171, 173, 176, 178, 179, 181, 205, 206, 207, 212, 217, 230, 231, 236, 237, 240, 250, 251, 252, 260, 261, 300, 302, 311, 312, 313, 314, 315, 319, 320, 414, 417, 418, 419, 421, 422, 505, 506, 529, 530, 537, 540, 541, 551, 553, 555, 557, 558, 561, 562, 563, 577, 683, 700, 701, 706, 707, 708, 709, 714, 715, 716, 717, 719, 721, 722, 730, 731, 732, 734, 739, 740, 741, 742, 744, 745, 747, 748, 749, 750, 751, 755, 760, 777, 779, 911, 919, 934, 935, 997, 998, 999, 1000, 1023, 1111, 1113, 1121, 1122, 1123, 1124, 1125, 1126, 1157, 1200, 1201, 1202, 1203, 1213, 1239, 1250, 1302, 1305, 1307, 1308, 1330, 1331, 1332, 1334, 1337, 1338, 1339, 1340, 1348, 1349, 1352, 1353, 1357, 1358, 1359, 1401, 1413, 1418, 1419, 1420, 1421, 1422, 1423, 1424, 1425, 1426, 1427, 1428, 1429, 1430, 1431, 1432, 1433, 1434, 1435, 1436, 1437, 1438, 1439, 1440, 1441, 1442, 1443, 1444, 1445, 1515, 1516, 1521, 1522, 1523, 1524, 1525, 1526, 1531, 1532, 1533, 1534, 1535, 1537, 1566, 1569, 1570, 1573, 1584, 1585, 1586, 1587, 1588, 1590, 1595, 1596, 1689, 1703, 1716, 1717, 1718, 1730, 1735, 1736, 1737, 1742, 1743, 1745, 1747, 1750, 1752, 1753, 1758, 1761, 1762, 1763, 1766, 1767, 1769, 1776, 1778, 1780, 1785, 1799, 1800, 1801, 1806, 1807, 1818, 1819, 1820, 1821, 1824, 1825, 1826, 1828, 1832, 1848, 1849, 1858, 1859, 1869, 1870, 1873, 1874, 1875, 1902, 1940, 1941, 2036, 2038, 2069, 2070, 2071, 2073, 2136, 2222, 2295, 2296, 2413, 2430, 2434, 2435, 2436, 2437, 2438, 2439, 2440, 2441, 2442, 2448, 2449, 2450, 2451, 2452, 2453, 2454, 2455, 2456, 2457, 2458, 2468, 2469, 2470, 2617, 2618, 2619, 2635, 2636, 2637, 2638, 2639, 2640, 2641, 2642, 2643, 2853, 2854, 2855, 2856, 2857, 2858, 2859, 2860, 2861, 2862, 2865, 3002, 3003, 3008, 3010, 3012, 3013, 3014, 3015, 3017, 3019, 3021, 3022, 3023, 3024, 3025, 3026, 3029, 3036, 3040, 3042, 3044, 3046, 3048, 3050, 3051, 3052, 3056, 3057, 3058, 3201, 3202, 3203, 3204, 3205, 3206, 3207, 3208, 3209, 3210, 3211, 3212, 3213, 3214, 3215, 3216, 3217, 3218, 3219, 3220, 3221, 3222, 3223, 3224, 3225, 3226, 3227, 3228, 3231, 3233, 3234, 3235, 3236, 3237, 3238, 3239, 3240, 3241, 3242, 3243, 3244, 3251, 3252, 3253, 3254, 3332, 3333, 3334, 3335, 3336, 3337, 3338, 3339, 3340, 3341, 3342, 3343, 3344, 3345, 3346, 3347, 3348, 3349, 3350, 3351, 3352, 3353, 3354, 3355, 3356, 3357, 3358, 3359, 3360, 3361, 3364, 3365, 3366, 3367, 3368, 3369, 3370, 3372, 3373, 3501, 3505, 3506, 3507, 3508, 3509, 3510, 3515, 3516, 3517, 3518, 3519, 3560, 3561, 3562, 3565, 3566, 3567, 3568, 3569, 3570, 3571, 3572, 3575, 3576, 3577, 3578, 3579, 3580, 3581, 3582, 3585, 3586, 3587, 3589, 3704, 3705, 3706, 3709, 3710, 3711, 3715, 3716, 3717, 3721, 3722, 3723, 3726, 3728, 3729, 3730, 3731, 3732, 3733, 3734, 3735, 3736, 3737, 3738, 3739, 3803, 3804, 3805, 3806, 3807, 3808, 3809, 3810, 3811, 3812, 3816, 3817, 3818, 3819, 3820, 3822, 3824, 3826, 3828, 3829, 3830, 3911, 3921, 3922, 3923, 3925, 3926, 3927, 3928, 3929, 3930, 3931, 3932, 3933, 3934, 3935, 3936, 3937, 3938, 3939, 3940, 3941, 3942, 3943, 3944, 3945, 3946, 3947, 3948, 3949, 3950, 3951, 3952, 3985, 3986, 3987, 3988, 3989, 3990, 3991, 3992, 3993, 3994, 3995, 4000, 4002, 4101, 4102, 4103, 4104, 4113, 4114, 4115, 4116, 4117, 4118, 4119, 4120, 4121, 4122, 4123, 4124, 4125, 4126, 4127, 4128, 4129, 4130, 4131, 4132, 4133, 4134, 4139, 4140, 4141, 4142, 4143, 4144, 4145, 4146, 4147, 4148, 4149, 4150, 4151, 4152, 4153, 4154, 4155, 4156, 4157, 4158, 4159, 4160, 4161, 4162, 4163, 4164, 4165, 4166, 4167, 4168, 4169, 4171, 4172, 4173, 4174, 4175, 4176, 4177, 4178, 4179, 4180, 4181, 4182, 4183, 4184, 4185, 4186, 4187, 4188, 4189, 4190, 4191, 4193, 4194, 4195, 4196, 4197, 4198, 4199, 4201, 4202, 4203, 4204, 4212, 4213, 4214, 4215, 4216, 4217, 4218, 4219, 4220, 4221, 4222, 4223, 4224, 4225, 4226, 4227, 4228, 4229, 4230, 4231, 4232, 4233, 4234, 4239, 4240, 4241, 4242, 4243, 4244, 4245, 4246, 4247, 4248, 4249, 4250, 4251, 4252, 4253, 4254, 4255, 4256, 4257, 4258, 4259, 4260, 4261, 4262, 4263, 4264, 4265, 4266, 4267, 4268, 4269, 4271, 4272, 4273, 4274, 4275, 4276, 4277, 4278, 4279, 4280, 4281, 4282, 4283, 4284, 4285, 4286, 4287, 4288, 4289, 4290, 4291, 4293, 4294, 4295, 4296, 4297, 4298, 4299, 4301, 4302, 4303, 4304, 4312, 4313, 4314, 4315, 4316, 4317, 4318, 4319, 4320, 4321, 4322, 4323, 4324, 4325, 4326, 4327, 4328, 4329, 4330, 4331, 4332, 4333, 4334, 4339, 4340, 4341, 4342, 4343, 4344, 4345, 4346, 4347, 4348, 4349, 4350, 4351, 4352, 4353, 4354, 4355, 4356, 4357, 4358, 4359, 4360, 4361, 4362, 4363, 4364, 4365, 4366, 4367, 4368, 4369, 4371, 4372, 4373, 4374, 4375, 4376, 4377, 4378, 4379, 4380, 4381, 4382, 4383, 4384, 4385, 4386, 4387, 4388, 4389, 4390, 4391, 4393, 4394, 4395, 4396, 4397, 4398, 4399, 4401, 4402, 4403, 4404, 4405, 4406, 4407, 4408, 4409, 4434, 4435, 4436, 4437, 4438, 4439, 4440, 4441, 4442, 4467, 4468, 4469, 4470, 4471, 4472, 4473, 4474, 4475, 4476, 4477, 4596, 4597, 4598, 4599, 4600, 4601, 4602, 4603, 4604, 4605, 4606, 4607, 4608, 4609, 4610, 4611, 4612, 4613, 4614, 4615, 4616, 4617, 4618, 4619, 4620, 4621, 4622, 4623, 4624, 4625, 5010
])

#故障描述
fname = pd.Series([
    '变流器2CANopen通讯故障', '变流器电网过压', '振动传感器Y向振动大于设定值3', '参数读取错误', '齿轮箱水冷泵入口压力低停机', '机舱消防预报警', '主控IO模块错误', '变流器加热启动', '电网电压大于高电压保护设定值3', '塔底柜交流UPS异常报警', '变桨轴1电机过流计算保护', '机舱振动超限', '变桨轴3心跳反馈异常', '塔底柜400V进线保护开关跳闸停机', '风机正在除湿', '维护状态停机', '机舱/塔底手动停机', '机舱火灾停机', '机舱柜火灾停机', '脉冲继电器断开', '机舱温度高停机', '塔底柜加热器保护开关跳闸', '机舱温度低停机', '机舱除湿机保护开关跳闸', '塔底柜24V供电保护开关跳闸停机', '塔底柜开关电源保护开关跳闸停机', '塔底柜中压柜24VDC保护开关跳闸停机', '塔底柜灭火器反馈停机', '塔底小干变绕组温度高停机', '塔底小干变温度传感器损坏', '机舱柜手动急停', '变桨备用电源测试停机', '相电压跌落', '电网电压大于高电压保护设定值1', '电网电压大于高电压保护设定值2', '电网电压大于高电压保护设定值4', '电网电压小于低电压保护设定值1', '电网电压小于低电压保护设定值2', '电网电压小于低电压保护设定值3', '电网电压小于低电压保护设定值4', '电网频率大于高频率保护设定值1', '电网频率大于高频率保护设定值2', '电网频率小于低频率保护设定值1', '电网频率小于低频率保护设定值2', '电网频率大不允许并网', '断路器柜V断路器分闸停机', '负荷开关柜C1负荷开关分闸停机', '变压器400V熔丝故障停机', '变压器室消防停机', '变压器U相绕组温度高停机', '变压器V相绕组温度高停机', '变压器W相绕组温度高停机', '变压器室门打开快速停机', '变压器绕组温度信号不变化', '变压器风扇状态异常', '变压器绕组温度传感器故障停机', '变压器铁芯温度传感器故障停机', '变压器温度高停机后断开高压柜', '变压器2室消防停机', '变压器2相绕组温度高停机', '变压器2绕组温度信号不变化', '变压器2绕组温度传感器故障停机', '变压器2铁芯温度传感器故障停机', '变压器2室门打开快速停机', '转速提升超时停机', '风速仪结冰停机', '叶片结冰停机', '空转除冰', '叶轮结冰质量不平衡保护停机', '风速仪故障停机', '风速仪信号输出异常', '机舱外温度低停机', '机舱外温度高停机', '航空灯保护开关跳闸', '300s平均风速超限停机', '30s平均风速超限停机', '3s平均风速超限停机', '风向仪故障停机', '扇区管理停机', '发电机转速接近开关故障', '主轴接近开关故障', '主轴超速停机', '发电机超速停机', '主轴超速重复故障停机', '发电机超速重复故障停机', '紧急偏航', '发电机超速开关断开', '主轴超速开关断开', '刹车信号与反馈不符停机', '液压站刹车阀保护开关跳闸', '高速轴刹车片磨损停机', '高速轴刹车继电器故障', '高速轴刹车片温度高停机', '高速轴刹车制动器压力高停机', '发电机驱动端轴承温度高停机重复故障', '发电机非驱动端轴承温度高停机重复故障', '电网过功率继电器断开', '发电机功率过高停机', '发电机绕组温度传感器故障停机', '发电机绕组温度高停机', '发电机绕组温度高重复故障停机', '发电机润滑泵缺脂', '请给发电机润滑泵加脂！', '发电机电刷磨损停机', '发电机风扇PTC开关保护停机', '发电机润滑泵分配器阻塞停机', '发电机水冷泵出口压力高停机', '发电机入水口温度高停机', '发电机水冷泵电机MCB跳闸停机', '发电机水泵压力开关断开停机', '发电机滑环加热器保护开关跳闸', '偏航零点校准失败', '偏航重复故障停机', '逆时针偏航反馈故障停机', '顺时针偏航反馈故障停机', '逆时针扭缆超限停机', '顺时针扭缆超限停机', '风机小风自动解缆', '风机正在自动解缆', '扭缆方向与扭缆角度不符停机', '扭缆角度校正', '偏航电机总保护开关跳闸', '偏航电机制动器保护开关跳闸停机', '扭缆极限（限位开关）', '偏航传感器故障停机', '偏航软启动器故障', '人机界面手动偏航激活', '偏航误差大停机', '偏航回路压力传感器故障', '偏航电流互感器故障', '偏航背压压力高', '偏航避载', '偏航电机保护开关跳闸停机', '偏航电机PTC开关断开停机', '请检查纽揽(机舱按钮复位)', '偏航液压刹车压力执行超时', '偏航软启控制电源MCB跳闸', '偏航电机制动器接触器异常停机', '防冰砸模式', '风机正在偏航维护', '偏航传感器同时变化故障停机', '备用电源供电应急偏航模式', '扭缆自动校准', '机舱求救', '抗涡激桨叶位置未执行到位', '发电机风扇保护开关跳闸停机', '发电机风扇2保护开关跳闸', 'Y型防冰砸激活', 'Y型防冰砸停机', '抗涡激模式', '系统正常', '变流器CANopen通讯故障', '编码器转速测量异常', '单轴桨叶角度不一致停机', '变桨轴1跟随误差大', '变桨轴2跟随误差大', '变桨轴3跟随误差大', '变桨轴1轴2变桨位置偏差大', '变桨轴2轴3变桨位置偏差大', '变桨轴1轴3变桨位置偏差大', '变桨CANOPEN通讯故障', '液压站压力低', '液压站液位低', '液压站油温高停机', '液压站接触器异常停机', '液压泵运行超时', '液压泵保护开关跳闸', '主轴滑环加热器保护开关反馈', '齿轮箱风扇保护开关跳闸', '齿轮箱油液位低', '齿轮箱入水口温度高停机', '齿轮箱行星轴位移超限停机', '齿轮箱油温度高持续过长停机', '齿轮箱油温高停机', '齿轮箱油泵保护开关跳闸', '油温累计超时故障停机', '齿轮箱高速轴输入端轴承温度高长时间停机', '齿轮箱高速轴输出端轴承温度高长时间停机', '齿轮箱高速轴输入端轴承温度高停机', '齿轮箱高速轴输出端轴承温度高停机', '齿轮箱油泵高速接触器故障停机', '齿轮箱油泵低速接触器故障停机', '齿轮箱中间轴输入端轴承温度高停机', '齿轮箱中间轴输出端轴承温度高停机', '齿轮箱三级转架电机侧轴承温度高持续时间长停机', '齿轮箱三级转架电机侧轴承温度高停机', '齿轮箱油温高重复故障停机', '变流器转矩跟随故障', '变流器故障跳闸', '直流母线电压过高', '直流母线电压欠压', '定子过流', '转子过流', 'ISU过流', 'INU过温', 'ISU过温', '超速', '欠速', 'INU接地', 'ISU接地', '主电缆或NDCU33CX温度故障', 'CH0通讯丢失', 'CH1通讯故障', 'ISUINU之间通讯', '编码器故障', 'NUIM板故障', '转子门级驱动故障', 'ABB变流器系统故障', 'INU启动故障', 'ISU启动故障', 'ISU充电故障', 'LCL温度故障', 'MCB准备故障', 'MCB响应故障', 'INU其他故障', 'ISU其他故障', 'Crowbar跳闸', '振动传感器通讯停机', '振动传感器故障停机', '振动传感器1X向振动大于设定值1', '振动传感器1X向振动大于设定值2', '振动传感器1X向振动大于设定值3', '振动传感器1Y向振动大于设定值1', '振动传感器1Y向振动大于设定值2', '振动传感器1Y向振动大于设定值3', '振动传感器X向振动大于设定值1', '振动传感器X向振动大于设定值2', '振动传感器X向振动大于设定值3', '振动传感器Y向振动大于设定值1', '振动传感器Y向振动大于设定值2', '机舱长时间振动大停机', '机舱柜温度高停机', '润滑泵及气象加热供电MCB跳闸', '机舱柜UPS开关电源供电开关保护开关跳闸停机', '机组停机状态下振动大于设定值', '风轮锁供电反馈跳闸', '维护销子锁住', '距离传感器偏差大', '距离传感器故障停机', '轮毂方位角偏差大', '轮毂方位角偏差大停机', '自检超时停机', '空转超时停机', '并网超时停机', '机舱外部紧急停机', '变流器水冷泵出入口压差低停机', '齿轮箱水冷泵出入口压差低停机', '发电机水冷泵出入口压差低停机', '偏航等待停机', '轴1通信故障', '轴2通信故障', '轴3通信故障', '偏航时驱动电流过大重复故障', '偏航刹车片磨损停机', '齿轮箱出水口温度高停机', '变流器出水口温度高停机', '齿轮箱水冷泵电机保护开关跳闸停机', '齿轮箱水冷压力开关断开停机', '齿轮箱水冷泵接触器故障停机', '发电机水冷泵接触器故障停机', '变流器加热除湿请求', '变流器水冷泵电机保护开关跳闸停机', '变流器水冷泵电机接触器故障停机', '变流器入水口温度高停机', '变流器水冷泵出口压力高停机', '辅助电源故障', '发电机水冷泵入口压力低停机', '变流器电加热器故障', '齿轮箱水冷泵出口压力高停机', '变流器水冷泵入口压力低停机', '电能表通讯异常', '齿轮箱变流器水冷泵出口压力高停机', '发电机变压器水冷泵出口压力高停机', '齿轮箱变流器水冷泵入口压力低停机', '发电机变压器水冷泵入口压力低停机', '齿轮箱变流器水冷泵电机保护开关跳闸', '发电机变压器水冷泵电机保护开关跳闸', '齿轮箱变流器水冷泵电机接触器故障', '发电机变压器水冷泵电机接触器故障', '齿轮箱变流器水冷加热器保护开关跳闸', '齿轮箱变流器水冷加热器接触器故障', '齿轮箱变流器水冷加热器故障', '齿轮箱变流器水冷三通阀保护开关跳闸', '刹车超时停机', '发电机水套入水口温度高停机', '发电机空水换热器入水口温度高停机', '发电机齿轮箱1水冷泵电机MCB跳闸停机', '发电机齿轮箱2水冷泵电机MCB跳闸停机', '发电机齿轮箱1水冷三通阀MCB跳闸', '发电机齿轮箱2水冷三通阀MCB跳闸', '变流器2水冷泵出入口压差低停机', '发电机齿轮箱1水冷泵入口压力低停机', '发电机齿轮箱2水冷泵入口压力低停机', '机舱柜变桨400V保护开关跳闸', '轴间桨叶角度不一致停机', '变桨控制器安全链断开', '发电机驱动端轴承温度超限停机', '发电机非驱动端轴承温度超限停机', '变桨供电过压保护模块断开', '400V变压器输入端保护开关跳闸', '机舱柜230V变压器保护开关跳闸', '机舱400V设备总保护开关跳闸停机', '塔底紧急停机', '气动刹车故障停机', '主轴承温度高停机', '主轴承温度高停机重复故障', '机舱风扇2保护开关跳闸', '安全继电器断开', '机舱柜主电反馈异常', '安全链继电器1断开', '安全链继电器2断开', '安全链复位按键卡住', '变桨系统故障', '变桨安全链反馈断开', '机舱手动安全停机', '塔底手动安全停机', '机舱或塔底启机按钮卡住停机', 'SCADA手动停机', '集控中心手动停机', '人机界面手动停机', '能量管理平台停机', '安全链PLC心跳异常', '主控主动断开安全链', '主控断开安全链普通继电器', '主控断开安全链紧急继电器', '变流器安全链反馈断开', '安全链PLC保护开关跳闸', '在线振动监测系统停机', '市电230V供电异常', '机舱230V保护开关跳闸', '机舱加热器保护开关跳闸', '轴1驱动器扩展IO模块通讯状态故障', '轴2驱动器扩展IO模块通讯状态故障', '轴3驱动器扩展IO模块通讯状态故障', '轴124V回路开关断开', '轴224V回路开关断开', '轴324V回路开关断开', '轴191度限位开关故障', '轴291度限位开关故障', '轴391度限位开关故障', '轴1备用电源回路开关断开', '轴2备用电源回路开关断开', '轴3备用电源回路开关断开', '变流器水压过低', '变流器水压压力差', '变流器水冷过高', '变流器水温过低', '变流器供电电压低', '阳光变流器急停', '阳光变流器网侧过热', '阳光变流器机侧过热', '阳光变流器电机超速', '阳光变流器加热启动', '变流器UPS自检异常', '发电机温度开关跳闸', '液压站压力过高', '齿轮箱过滤压差高停机', '齿轮箱分配器出口压力低停机', '齿轮箱过滤器入口压力大停机', '齿轮箱油泵电机未正常启动', '齿轮箱过滤器2入口压力大停机', '请给偏航润滑泵加脂！', '偏航润滑泵泵阻塞停机', '变桨润滑泵阻塞停机', '变桨润滑泵缺脂', '偏航润滑泵缺脂', '主轴润滑泵缺脂', '请给主轴润滑泵加脂！', '主轴润滑泵泵阻塞停机', '请给变桨润滑泵加脂！', '主轴轴承废油收集系统漏油故障停机', '变桨轴承废油收集系统漏油故障停机', '变桨润滑泵2缺脂', '单线变桨润滑泵漏脂故障停机', '单线主轴润滑泵压力传感器故障停机', '单线主轴润滑泵漏脂故障停机', '单线变桨润滑泵压力传感器故障停机', '偏航摩擦片润滑泵泵阻塞停机', '偏航摩擦片润滑泵缺脂', '偏航摩擦片偏航润滑泵加脂！', '变桨齿轮润滑泵阻塞停机', '变桨齿轮润滑泵缺脂', '请给变桨齿轮润滑泵加脂！', '变流器电网欠压', '变流器电网过频', '变流器电网欠频', '变流器母线过压', '变流器母线欠压', '变流器定子过流', '变流器转子过流', '变流器网侧过流', '变流器机侧过热', '变流器网侧过热', '变流器转子超速', '变流器转子欠速', '变流器转子电流不平衡', '变流器定子子电流不平衡', '变流器内部CAN通讯错误', '变流器整流逆变通讯故障', '变流器驱动故障', '变流器系统故障', '变流器机侧开启故障', '变流器网侧开启故障', '变流器网侧充电故障', '变流器网侧电感过热', '变流器MCB储能故障', '变流器MCB状态反馈故障', '变流器机侧其他故障', '变流器网侧其他故障', '变流器Crowbar触发', '变流器急停', '变流器电机超速', '变流器机舱除湿', '变流器网侧本地控制', '变流器网侧启动禁止', '变流器转子漏电流过大', '变流器IGBT过流', '变流器并网接触器故障', '变流器同步失败', '变流器驱动板连接线异常', '变流器AD零漂过大', '变流器电网电压跌落超限', '变流器功率偏差大', '变流器防火系统动作', '机舱火探系统压力异常停机', '机舱火探系统动作停机', '塔基火探系统压力异常停机', '塔基火探系统动作停机', 'NARI变流器直流母线过压', 'NARI变流器直流母线欠压', '变流器网侧A相瞬时过流', '变流器网侧B相瞬时过流', '变流器网侧C相瞬时过流', '变流器网侧延时过流', 'NARI变流器网侧硬件过流', '变流器网侧电流零序故障', 'NARI变流器网侧电流不平衡故障', '变流器机侧A相瞬时过流', '变流器机侧B相瞬时过流', '变流器机侧C相瞬时过流', '变流器机侧模块延时过流', '变流器机侧模块硬件过流', '变流器机侧电流零序故障', '变流器机侧电流不平衡故障', '变流器双馈定子延时过流', '变流器双馈定子电流零序故障', '变流器双馈定子电流不平衡故障', '变流器网侧滤波电流过流故障', '变流器网侧滤波电流不平衡故障', '变流器起停机指令异常', '变流器转矩指令突变', '变流器转矩超限', '变流器主断故障跳闸（小红点弹出）', '变流器主控安全链故障', '变流器定子同期超时', '变流器状态机运行状态异常', '变流器重复故障', '变流器错误触发故障', '变流器网侧模块温度过高', '变流器网侧模块温差过大', '变流器机侧模块温度过高', '变流器机侧模块温差过大', '变流器环境温度过高', '变流器功率柜温度过高', '变流器控制柜温度过高', 'NARI变流器UPS市电故障', '变流器风机拒动', '控制器光纤模块故障停机', '发电机绕组温度信号不变化', '发电机轴承温度信号不变化', '齿轮箱温度信号不变化', '齿轮箱压力信号不变化', '室外温度信号不变化', '液压站压力信号不变化', '变流器2母线过温', '变流器2EEPROM写失败', '变流器2Utils库版本错误', '变流器2背板异常', '变流器未就绪', '变桨轴1变桨控制器使能', '变桨轴191度限位动作', '变桨轴195度限位动作', '变桨轴1安全链断开', '变桨轴1变桨控制器工作在非自动模式', '变桨轴1Teach失败', '变桨轴1心跳反馈异常', '变桨轴1控制器故障', '变桨轴2控制器使能状态', '变桨轴291度限位动作', '变桨轴295度限位动作', '变桨轴2安全链断开', '变桨轴2变桨控制器工作在非自动模式', '变桨轴2Teach失败', '变桨轴2心跳反馈异常', '变桨轴2控制器故障', '变桨轴3控制器使能状态', '变桨轴391度限位动作', '变桨轴395度限位动作', '变桨轴3安全链断开', '变桨轴3变桨控制器工作在非自动模式', '变桨轴3Teach失败', '变桨轴3控制器故障', '变桨轴1备用电源电压不平衡故障', '变桨轴2备用电源电压不平衡故障', '变桨轴3备用电源电压不平衡故障', '轴1驱动器参数或固件设置错误', '轴2驱动器参数或固件设置错误', '轴3驱动器参数或固件设置错误', '轴1电机I^2T保护激活故障', '轴2电机I^2T保护激活故障', '轴3电机I^2T保护激活故障', '轴1驱动器I^2T保护激活故障', '轴2驱动器I^2T保护激活故障', '轴3驱动器I^2T保护激活故障', '变桨控制器与客户柜扩展模块通讯故障', '变桨轴1备用电源测试故障', '变桨轴2备用电源测试故障', '变桨轴3备用电源测试故障', '变桨电网供电故障', '变桨防雷保护失效', '变桨接口模块轴1DC/DC转换单元故障', '变桨接口模块轴2DC/DC转换单元故障', '变桨接口模块轴3DC/DC转换单元故障', '变桨接口模块AC/DC控制器故障', '变桨接口模块DC/DC控制器总故障', '变桨系统普通故障', '变桨系统紧急故障', '变桨指令不正常', '变桨速率过低', '变桨角度过低', '额定桨角过低', '轴1轴2变桨指令误差大', '轴2轴3变桨指令误差大', '轴1轴3变桨指令误差大', '轴1跟随误差大', '轴2跟随误差大', '轴3跟随误差大', '风向偏差过大', '发电机转速加速度过大', '发电机转速与主轴转速不一致', '转矩跟随误差大', '算法程序执行超时', '算法程序长时间循环周期误差大', '塔架共振区超时停机', '风速风向偏差过大停机', '传动链振动超限停机', '算法程序心跳异常停机', '偏航误差大限功率停机', '齿轮箱高速端1超速开关断开', '变桨系统处于非正常变桨状态', '变桨系统紧急故障触发', '变桨系统普通故障触发', '变桨系统监测电网低穿（LVRT）中', '变桨系统监测电网高穿(HVRT)中', '轴1限位开关A激活', '轴1限位开关B激活', '轴1驱动器服务模式激活', '轴2限位开关A激活', '轴2限位开关B激活', '轴2驱动器服务模式激活', '轴3限位开关A激活', '轴3限位开关B激活', '轴3驱动器服务模式激活', 'SSB轴1驱动器故障', 'SSB轴2驱动器故障', 'SSB轴3驱动器故障', '轴1后备电源主开关断开', '轴2后备电源主开关断开', '轴3后备电源主开关断开', '轴1后备电源电压欠压', '轴2后备电源电压欠压', '轴3后备电源电压欠压', '轴1后备电源电压过压', '轴2后备电源电压过压', '轴3后备电源电压过压', 'SSB轴1电机过温', 'SSB轴2电机过温', 'SSB轴3电机过温', '变桨控制器与轴1驱动器通信超时', '变桨控制器与轴2驱动器通信超时', '轴2电机与桨叶编码器间超差', '轴3电机与桨叶编码器间超差', '轴1与其它两轴位置超差', '轴2与其它两轴位置超差', '轴3与其它两轴位置超差', '轴1的电网侧24V电源故障', '轴2的电网侧24V电源故障', '轴3的电网侧24V电源故障', '轴1充电器故障', '轴2充电器故障', '轴3充电器故障', '低电压穿越', '高电压穿越', '变桨轴1驱动单元过流', '变桨轴1模拟量检测过流', '变桨轴1直流母排过压', '变桨轴1直流母排欠压', '变桨轴1电机过流计算可复位保护', '变桨轴1电机过温', '变桨轴1电机过温可复位', '变桨轴1电机超速', '变桨轴1电机参数设置错误', '变桨轴1电机参数没有保存', '变桨轴1系统辨识过程出错', '变桨轴1两个编码器反馈差过大', '变桨轴1FPGA配置失败', '变桨轴1功率模块通讯故障', '变桨轴1功率模块数据非法', '变桨轴1C6软件开关拨向左边', '变桨轴1C6软件开关拨向右边', '变桨轴1C6模块与功率模块通讯错误', '变桨轴1外部设置错误输入高电平', '变桨轴1功率模块更换', '变桨轴1功率模块型号更换', '变桨轴1最大加减速超过限值', '变桨轴1编码器A故障', '变桨轴1编码器B故障', '变桨轴1编码器没有连接正确', '变桨轴1通讯地址拨码超出范围', '变桨轴1伺服柜内风扇故障', '变桨轴1伺服柜外风扇故障', '变桨轴186度感应开关未能触发', '变桨轴15度感应开关相应位置未能触发', '变桨轴186度感应开关不该触发时触发', '变桨轴15度感应开关不该触发时触发', '变桨轴1桨叶位置超出正常工作范围', '变桨轴1超级电容充电失效', '变桨轴1超级电容过压', '变桨轴1电网掉电', '变桨轴1超级电容容量检测失败', '变桨轴1超级电容未连接', '变桨轴1超级电容容量低于门限值', '变桨轴1超级电容容量高于门限值', '变桨轴1电机制动器开路', '变桨轴1电机制动器短路', '变桨轴1电机制动器制动力矩不足', '变桨轴1变桨柜温度过高', '变桨轴1电容柜温度过高', '变桨轴1电机KTY温度检测开路', '变桨轴1电机KTY温度检测短路', '变桨轴1自动模式下通讯故障', '变桨轴1C6与功率模块通讯错误', '变桨轴1变桨电机堵转', '变桨轴1变桨控制柜主开关关闭', '变桨轴191度限位开关非正常触发', '变桨轴195度限位开关非正常触发', '变桨轴1主电源防雷模块热脱扣', '变桨轴1禁止超级电容充电', '变桨轴1电机电缆开路', '变桨轴1控制器DO输出过载', '变桨轴1硬件EFC信号丢失', '变桨轴113Q1开关断开', '变桨轴1电容保险熔断', '变桨轴1驱动器无授权', '变桨轴1驱动器电流采样异常', '变桨轴1加速过电流', '变桨轴1减速过电流', '变桨轴1恒速过电流', '变桨轴1加速过电压', '变桨轴1减速过电压', '变桨轴1恒速过电压', '变桨轴1直流母线欠压故障', '变桨轴1驱动器过载', '变桨轴1电机过载', '变桨轴1输出缺相', '变桨轴1模块过热', '变桨轴1外部故障', '变桨轴1内部通讯状态机故障', '变桨轴1电机自学习故障', '变桨轴1编码器故障', '变桨轴1EEPROM故障', '变桨轴1电机对地短路', '变桨轴1电机相间短路', '变桨轴1累计运行时间到达', '变桨轴1累计上电时间到达', '变桨轴1掉载故障', '变桨轴1速度偏差过大', '变桨轴1电机过速度故障', '变桨轴2驱动单元过流', '变桨轴2模拟量检测过流', '变桨轴2直流母排过压', '变桨轴2直流母排欠压', '变桨轴2电机过流计算保护', '变桨轴2电机过流计算可复位保护', '变桨轴2电机过温', '变桨轴2电机过温可复位', '变桨轴2电机超速', '变桨轴2电机参数设置错误', '变桨轴2电机参数没有保存', '变桨轴2系统辨识过程出错', '变桨轴2两个编码器反馈差过大', '变桨轴2FPGA配置失败', '变桨轴2功率模块通讯故障', '变桨轴2功率模块数据非法', '变桨轴2C6软件开关拨向左边', '变桨轴2C6软件开关拨向右边', '变桨轴2C6模块与功率模块通讯错误', '变桨轴2外部设置错误输入高电平', '变桨轴2功率模块更换', '变桨轴2功率模块型号更换', '变桨轴2最大加减速超过限值', '变桨轴2编码器A故障', '变桨轴2编码器B故障', '变桨轴2编码器没有连接正确', '变桨轴2通讯地址拨码超出范围', '变桨轴2伺服柜内风扇故障', '变桨轴2伺服柜外风扇故障', '变桨轴286度感应开关未能触发', '变桨轴25度感应开关相应位置未能触发', '变桨轴286度感应开关不该触发时触发', '变桨轴25度感应开关不该触发时触发', '变桨轴2桨叶位置超出正常工作范围', '变桨轴2超级电容充电失效', '变桨轴2超级电容过压', '变桨轴2电网掉电', '变桨轴2超级电容容量检测失败', '变桨轴2超级电容未连接', '变桨轴2超级电容容量低于门限值', '变桨轴2超级电容容量高于门限值', '变桨轴2电机制动器开路', '变桨轴2电机制动器短路', '变桨轴2电机制动器制动力矩不足', '变桨轴2变桨柜温度过高', '变桨轴2电容柜温度过高', '变桨轴2电机KTY温度检测开路', '变桨轴2电机KTY温度检测短路', '变桨轴2自动模式下通讯故障', '变桨轴2C6与功率模块通讯错误', '变桨轴2变桨电机堵转', '变桨轴2变桨控制柜主开关关闭', '变桨轴291度限位开关非正常触发', '变桨轴295度限位开关非正常触发', '变桨轴2主电源防雷模块热脱扣', '变桨轴2禁止超级电容充电', '变桨轴2电机电缆开路', '变桨轴2控制器DO输出过载', '变桨轴2硬件EFC信号丢失', '变桨轴213Q1开关断开', '变桨轴2电容保险熔断', '变桨轴2驱动器无授权', '变桨轴2驱动器电流采样异常', '变桨轴2加速过电流', '变桨轴2减速过电流', '变桨轴2恒速过电流', '变桨轴2加速过电压', '变桨轴2减速过电压', '变桨轴2恒速过电压', '变桨轴2直流母线欠压故障', '变桨轴2驱动器过载', '变桨轴2电机过载', '变桨轴2输出缺相', '变桨轴2模块过热', '变桨轴2外部故障', '变桨轴2内部通讯状态机故障', '变桨轴2电机自学习故障', '变桨轴2编码器故障', '变桨轴2EEPROM故障', '变桨轴2电机对地短路', '变桨轴2电机相间短路', '变桨轴2累计运行时间到达', '变桨轴2累计上电时间到达', '变桨轴2掉载故障', '变桨轴2速度偏差过大', '变桨轴2电机过速度故障', '变桨轴3驱动单元过流', '变桨轴3模拟量检测过流', '变桨轴3直流母排过压', '变桨轴3直流母排欠压', '变桨轴3电机过流计算保护', '变桨轴3电机过流计算可复位保护', '变桨轴3电机过温', '变桨轴3电机过温可复位', '变桨轴3电机超速', '变桨轴3电机参数设置错误', '变桨轴3电机参数没有保存', '变桨轴3系统辨识过程出错', '变桨轴3两个编码器反馈差过大', '变桨轴3FPGA配置失败', '变桨轴3功率模块通讯故障', '变桨轴3功率模块数据非法', '变桨轴3C6软件开关拨向左边', '变桨轴3C6软件开关拨向右边', '变桨轴3C6模块与功率模块通讯错误', '变桨轴3外部设置错误输入高电平', '变桨轴3功率模块更换', '变桨轴3功率模块型号更换', '变桨轴3最大加减速超过限值', '变桨轴3编码器A故障', '变桨轴3编码器B故障', '变桨轴3编码器没有连接正确', '变桨轴3通讯地址拨码超出范围', '变桨轴3伺服柜内风扇故障', '变桨轴3伺服柜外风扇故障', '变桨轴386度感应开关未能触发', '变桨轴35度感应开关相应位置未能触发', '变桨轴386度感应开关不该触发时触发', '变桨轴35度感应开关不该触发时触发', '变桨轴3桨叶位置超出正常工作范围', '变桨轴3超级电容充电失效', '变桨轴3超级电容过压', '变桨轴3电网掉电', '变桨轴3超级电容容量检测失败', '变桨轴3超级电容未连接', '变桨轴3超级电容容量低于门限值', '变桨轴3超级电容容量高于门限值', '变桨轴3电机制动器开路', '变桨轴3电机制动器短路', '变桨轴3电机制动器制动力矩不足', '变桨轴3变桨柜温度过高', '变桨轴3电容柜温度过高', '变桨轴3电机KTY温度检测开路', '变桨轴3电机KTY温度检测短路', '变桨轴3自动模式下通讯故障', '变桨轴3C6与功率模块通讯错误', '变桨轴3变桨电机堵转', '变桨轴3变桨控制柜主开关关闭', '变桨轴391度限位开关非正常触发', '变桨轴395度限位开关非正常触发', '变桨轴3主电源防雷模块热脱扣', '变桨轴3禁止超级电容充电', '变桨轴3电机电缆开路', '变桨轴3控制器DO输出过载', '变桨轴3硬件EFC信号丢失', '变桨轴313Q1开关断开', '变桨轴3电容保险熔断', '变桨轴3驱动器无授权', '桨叶角过大保护停机(短时)', '桨叶角过大保护停机(长时)', '变桨轴3减速过电流', '变桨轴3恒速过电流', '变桨轴3加速过电压', '变桨轴3减速过电压', '变桨轴3恒速过电压', '变桨轴3直流母线欠压故障', '变桨轴3驱动器过载', '变桨轴3电机过载', '变桨轴3输出缺相', '变桨轴3模块过热', '变桨轴3外部故障', '变桨轴3内部通讯状态机故障', '变桨轴3电机自学习故障', '变桨轴3编码器故障', '变桨轴3EEPROM故障', '变桨轴3电机对地短路', '变桨轴3电机相间短路', '变桨轴3累计运行时间到达', '变桨轴3累计上电时间到达', '变桨轴3掉载故障', '变桨轴3速度偏差过大', '变桨轴3电机过速度故障', '变桨轴1电机温度故障', '变桨轴1电机抱闸故障', '变桨轴1电网故障', '变桨轴1制动管故障', '变桨轴1充电机故障', '变桨轴1制动电阻故障', '变桨轴1内部通讯心跳超时故障', '变桨轴1散热风扇故障', '变桨轴1程序版本不匹配', '变桨轴2电机温度故障', '变桨轴2电机抱闸故障', '变桨轴2电网故障', '变桨轴2制动管故障', '变桨轴2充电机故障', '变桨轴2制动电阻故障', '变桨轴2内部通讯心跳超时故障', '变桨轴2散热风扇故障', '变桨轴2程序版本不匹配', '变桨轴3电机温度故障', '变桨轴3电机抱闸故障', '变桨轴3电网故障', '变桨轴3制动管故障', '变桨轴3充电机故障', '变桨轴3制动电阻故障', '变桨轴3内部通讯心跳超时故障', '变桨轴3散热风扇故障', '变桨轴3程序版本不匹配', '变桨轴3驱动器电流采样异常', '变桨轴3加速过电流', '轴三超级电容开关断开', '轴三超级电容模组过温', '轴三超级电容过压', '轴三超级电容欠压', '轴三超级电容容量低', '轴三超级电容电压不均衡', '轴三超级电容断线', '轴三充电器过压', '轴三充电器过流', '轴三充电器过载', '轴三加热器开关断开', '轴三柜内温度过高', '轴三轮毂内温度过高', '轴三电机驱动输出缺相', '轴三变桨电机温度过高', '轴三变桨电机堵转', '轴三驱动器内部通讯故障', '轴三驱动器I类故障触发', '轴三驱动器II类故障触发', '轴三开环运行超时', '轴三DSP参数固化', '轴一负3度限位开关触发', '轴一驱动器使能信号丢失', '轴一超级电容模阻故障', '轴二负3度限位开关触发', '轴二驱动器使能信号丢失', '轴二超级电容模阻故障', '轴三负3度限位开关触发', '轴三驱动器使能信号丢失', '轴三超级电容模阻故障', '齿轮箱液压弹性支撑压力低停机'
])

#故障部位，系统
fsyst = pd.Series([])

fault = pd.DataFrame({'fname':fname,'fnum':fnum.astype(int),'fsyst':fsyst})
fault['fsyst'] = fault['fname']

#故障索引号， 故障码（状态码）
snum = pd.Series([])

#故障组织，厂家风机状态
sname_org = pd.Series([])

#故障码原因，监控状态
sname = pd.Series([
    '故障停机', '电网故障', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '用户停机', '用户停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '计划停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '用户停机', '计划停机', '故障停机', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '计划停机', '计划停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '计划停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '计划停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '电网故障', '计划停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '用户停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '用户停机', '故障停机', '故障停机', '计划停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '计划停机', '计划停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '计划停机', '计划停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '用户停机', '用户停机', '用户停机', '用户停机', '用户停机', '用户停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '故障停机', '计划停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '电网故障', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '环境待命', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机'
])

state = pd.DataFrame({'type_org':sname_org,'snum':snum.astype(int),'state_type':sname})

# 并网转速
Rotspd_Connect = 1074.2 
# 额定转速
Rotspd_Rate = 1755.0 
# 转矩控制系数

# 最小桨距角
Pitch_Min = 0

# 并网状态
state_ = 64
#限功率状态
limpw_state = 80 #统一状态替换
#正常发电状态
stateNormal = 71

# # 合计风速
wspd = pd.Series([
    0, 0.5, 1, 1.5, 2, 2.5, 
    3. , 3.5, 4. , 4.5, 5. , 5.5, 6. , 6.5, 7. , 7.5, 8. , 8.5, 9. ,9.5,10. ,10.5,11. ,
    11.5,12. ,12.5,13. ,13.5,14. ,14.5, 15., 15.5, 16., 16.5,17. ,17.5,18. ,18.5,19. ,19.5,20. ,20.5,21. ,21.5,22. ,22.5,23. ,23.5,24. ,24.5,25. ])
# # 合计功率
pwrat = pd.Series([
    0,0,0,0,0,0,
    98,177.5,295.6, 454.2, 656.2, 899.8, 1182.3, 1507.5, 1883.4, 2314.8, 2798.6, 3326.0, 3821.1, 4201.7, 4461.1, 4490.7, 4499.9, 
    4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0
])