import data.efficiency_function as turbine_efficiency_function
from scipy import signal

def filter1(Df_all, Df_all_m):
    #Df_all['wdir'] = Df_all['wdir'].fillna(method='ffill')
    # Df_all['wdir0'] = Df_all['wdir']
    Df_all['wdir0'] = Df_all['wdir'] - Df_all['yaw']
    Df_all['wdir0'] = Df_all['wdir0'].fillna(0)
    #Df_all['wdir0'] = Df_all['wdir']
    Df_all['wdir0'] = turbine_efficiency_function.pass_filter(Df_all['wdir0'],0.2,5,11,0.5,1,1)#1:低通滤波器，2：中值滤波，3：wiener滤波，4：巴特沃斯滤波器
    # Df_all_m['wdir0','nanmean'] = Df_all_m['wdir','nanmean']
    Df_all_m['wdir0','nanmean'] = Df_all_m['wdir','nanmean'] - Df_all_m['yaw','nanmean']
    return Df_all, Df_all_m

def filter2(Df_all, Df_all_m, medfilt_num, filter1st_tao, choose_num):
    #Df_all['wdir'] = Df_all['wdir'].fillna(0)
    Df_all['wdir0'] = Df_all['wdir'] - Df_all['yaw']
    # Df_all['wdir0'] = Df_all['wdir']
    Df_all['wdir0'] = Df_all['wdir0'].fillna(0)
    Df_all['wdir0'] = turbine_efficiency_function.pass_filter(Df_all['wdir'],filter1st_tao,medfilt_num,11,0.5,1,choose_num)#1:低通滤波器，2：中值滤波，3：wiener滤波，4：巴特沃斯滤波器
    # Df_all_m['wdir0','nanmean'] = Df_all_m['wdir','nanmean']
    Df_all_m['wdir0','nanmean'] = Df_all_m['wdir','nanmean'] - Df_all_m['yaw','nanmean']
    
    return Df_all, Df_all_m

import pandas as pd
import numpy as np
#故障码
fnum = pd.Series([
    0, 924, 287, 691, 500, 797, 657, 656, 426, 193, 659, 658, 927, 654, 50, 480, 488, 272, 756, 884, 255, 799, 740, 51, 798, 186, 540, 559, 773, 224, 433, 55, 129, 223, 671, 266, 216, 1269, 1023, 536, 201, 254, 192, 163, 771, 613, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 31, 32, 33, 34, 35, 36, 37, 38, 39, 43, 45, 46, 47, 48, 53, 57, 58, 63, 71, 72, 73, 75, 77, 78, 83, 91, 93, 95, 97, 98, 100, 101, 103, 105, 109, 110, 112, 121, 122, 123, 124, 125, 126, 127, 128, 130, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 187, 188, 189, 190, 191, 194, 195, 196, 197, 198, 199, 200, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 217, 218, 219, 220, 221, 222, 251, 252, 257, 258, 259, 260, 261, 263, 268, 269, 270, 271, 273, 275, 276, 277, 278, 279, 280, 283, 289, 290, 291, 294, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 312, 313, 314, 318, 319, 320, 321, 323, 327, 329, 331, 333, 334, 335, 337, 338, 339, 340, 341, 347, 353, 356, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 374, 375, 376, 377, 378, 380, 385, 392, 400, 404, 405, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 421, 422, 423, 424, 425, 428, 432, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 458, 459, 460, 461, 475, 479, 485, 486, 487, 497, 498, 499, 501, 502, 503, 504, 505, 506, 507, 512, 516, 517, 518, 521, 531, 532, 533, 534, 535, 537, 538, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 576, 586, 587, 588, 590, 591, 592, 593, 594, 610, 611, 612, 619, 620, 621, 622, 623, 631, 632, 633, 636, 637, 638, 639, 640, 643, 645, 646, 647, 648, 649, 650, 655, 660, 661, 662, 663, 665, 666, 667, 672, 673, 676, 678, 697, 698, 699, 701, 704, 706, 707, 711, 712, 715, 717, 723, 724, 725, 726, 727, 728, 738, 739, 741, 742, 743, 744, 745, 746, 747, 748, 752, 753, 754, 755, 757, 758, 759, 760, 761, 762, 768, 770, 772, 774, 775, 776, 777, 778, 779, 781, 782, 790, 791, 792, 793, 801, 802, 803, 804, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 849, 850, 851, 852, 853, 856, 861, 862, 863, 864, 865, 866, 867, 868, 869, 871, 877, 878, 879, 880, 881, 882, 883, 885, 886, 888, 889, 890, 892, 894, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 926, 928, 931, 932, 933, 934, 935, 936, 941, 942, 943, 944, 945, 946, 947, 948, 951, 952, 953, 955, 956, 957, 958, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 986, 987, 988, 989, 990, 993, 994, 995, 996, 997, 998, 1001, 1002, 1003, 1004, 1005, 1008, 1009, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1024, 1025, 1026, 1030, 1031, 1032, 1033, 1034, 1035, 1161, 1162, 1163, 1164, 1165, 1166, 1167, 1168, 1169, 1170, 1171, 1172, 1173, 1174, 1175, 1176, 1177, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1192, 1193, 1194, 1195, 1196, 1197, 1198, 1199, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223, 1224, 1225, 1226, 1227, 1228, 1229, 1230, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1259, 1260, 1261, 1262, 1263, 1264, 1265, 1266, 1267, 1268, 1270, 1271, 1272, 1273, 1274, 1275, 1276, 1277, 1278, 1279, 1280, 1281, 1282, 1283, 1301, 1302, 1304, 1305

])

#故障描述
fname = pd.Series([
    '系统正常', 'PLC系统重启', '机舱柜齿轮箱润滑泵222Q1分闸', '塔基柜急停按钮按下', '机舱齿轮箱驱动端轴承温度较高', '主断路器跳闸', '待风状态', '风速10分钟值过大停机', '主轴转速与发电机转速偏差过大', '桨叶3PMC电机侧接地短路故障', '风机达到风机重启的等级', '风速达到激活偏航的等级', '叶片结冰停机', '风速1秒值过大停机', 'OAT变桨系统看门狗断开停机', '机舱齿轮箱油压过低停机重复性故障', '机舱齿轮箱油温较低', '机舱柜温度较低', '电网L1相电压偏低', '变频器CANbus总线受到干扰', '扭缆开关限位开关被触发', '变频器定子断路器故障', '塔基向机舱供电4Q6分闸状态', '桨叶1在95°限位', '变频器Crowbar触发', '桨叶2电池接口通信故障', '发电机滑环碳刷磨损停机', '发电机驱动端轴承温度较低', '变频器没有并行信号', '桨叶3PMC心跳信号超时', '超速继电器没有脉冲信号', '桨叶1的电机过热，冷却风扇失效', '桨叶1PMM与PMC间的直流回路中断', '桨叶2PMC心跳信号超时', '机舱柜或塔基柜手动停机按钮按下', '机舱24VUPS电池模式', '桨叶3电池接口通信故障', '轴控箱3PMC撞击挡块时检测到接近开关信号(5445)', '网侧电抗器过温故障', '发电机碳刷磨损报警', '桨叶3电池电压太低', '超速继电器继电器开关被触发', '桨叶3PMC控制器输出过流', '桨叶2PMC电机侧接地短路故障', '变频器没有准备控制信号', '风机位置与风向偏差过大', '变桨急停引起机组安全链断开', '轮毂温度超出最大限制', '轮毂温度低于最小限制', '轮毂温度高', '轮毂温度低', '轮毂温度较高', '轮毂温度较低', '轮毂温度重复性故障', '桨叶1轴控箱温度太高', '桨叶1轮毂温度太高', '桨叶1轴控箱温度太低', '桨叶1轮毂温度太低', '桨叶1轴控箱PMM散热器温度太高', '桨叶1轴控箱散热器温度太低', '桨叶1电机温度太高', '桨叶1电池温度太高', '桨叶1电池温度太低', '桨叶2轴控箱温度太高', '桨叶2轮毂温度太高', '桨叶2轴控箱温度太低', '桨叶2轮毂温度太低', '桨叶2轴控箱PMM散热器温度太高', '桨叶2轴控箱散热器温度太低', '桨叶2电机温度太高', '桨叶2电池温度太高', '桨叶2电池温度太低', '桨叶3轴控箱温度太高', '桨叶3中控箱温度太高', '桨叶3轴控箱温度太低', '桨叶3中控箱温度太低', '桨叶3轴控箱PMM散热器温度太高', '桨叶3轴控箱散热器温度太低', '桨叶3电机温度太高', '桨叶3电池温度太高', '桨叶3电池温度太低', '桨叶1的AB编码器偏差大', '桨叶同步故障等级1', '桨叶同步故障等级2', '重复桨叶同步故障等级1', '重复桨叶同步故障等级2', '桨叶1在91°限位', '桨叶1PMC未准备就绪', '桨叶1跟随错误', '桨叶2的AB编码器偏差大', '桨叶2在95°限位', '桨叶2电池电压故障', '桨叶2在91°限位', '桨叶2的电机过热，冷却风扇失效', '桨叶2PMC未准备就绪', '桨叶2跟随错误', '桨叶3的AB编码器偏差大', '桨叶3在95°限位', '桨叶3在91°限位', '桨叶3的电机过热，冷却风扇失效', '桨叶3PMC未准备就绪', '桨叶3跟随错误', '变桨系统电池充电状态不正常', '充电回路出现故障重复故障$R$N', '三个桨叶编码器故障', '三个桨叶都在91°位置', '桨叶设定值与实际值偏差大等级3', '桨叶设定值与实际值偏差大等级4', '变桨重复同步错误', '桨叶1PMC控制器输出过流', '桨叶1PMC电机侧接地短路故障', '桨叶1变桨系统进线电源过压', '桨叶1变桨系统进线电源欠压', '桨叶1变桨系统进线电源相序错误', '桨叶1直流回路PMC侧过压', '桨叶1直流回路PMM升压器侧过压', '桨叶1直流回路PMC侧欠压', '桨叶1电池电压太低', '桨叶1PMM24V电源进线侧过压', '桨叶1PMM24V电源进线侧欠压', '桨叶1斩波器故障', '桨叶1的存储器或PMM硬件故障', '桨叶1PMM程序存储器故障', '桨叶1PMM的看门狗复位故障', '桨叶1PMC程序故障或硬件故障', '桨叶1PMM模数转换器故障', '桨叶1PMM参数错误', '桨叶1PMC电源检测器失效', '桨叶1编码器故障', '桨叶1PMC电机编码器运算故障', '桨叶1电机编码器数据通道故障', '桨叶1桨叶编码器故障', '桨叶1电池接口通信故障', '桨叶1PMM心跳信号或接点监测失效', '桨叶1PMMCANbus通信故障', '桨叶1速度控制器输出频率超出最大转速频率', '桨叶1的跟随偏差太大', '桨叶1PMM防雷保护器激活', '桨叶2PMC控制器输出过流', '桨叶2变桨系统进线电源过压', '桨叶2变桨系统进线电源欠压', '桨叶2变桨系统进线电源相序错误', '桨叶2直流回路PMC侧过压', '桨叶2直流回路PMM升压器侧过压', '桨叶2直流回路PMC侧欠压', '桨叶2PMM与PMC间的直流回路中断', '桨叶2电池电压太低', '桨叶2PMM24V电源进线侧过压', '桨叶2PMM24V电源进线侧欠压', '桨叶2斩波器故障', '桨叶2的存储器或PMM硬件故障', '桨叶2PMM程序存储器故障', '桨叶2PMM的看门狗复位故障', '桨叶2PMC程序故障或硬件故障', '桨叶2PMM模数转换器故障', '桨叶2PMM参数错误', '桨叶2PMC电源检测器失效', '桨叶2编码器故障', '桨叶2PMC电机编码器运算故障', '桨叶2电机编码器数据通道故障', '桨叶2桨叶编码器故障', '桨叶2PMM心跳信号或接点监测失效', '桨叶2PMMCANbus通信故障', '桨叶2速度控制器输出频率超出最大转速频率', '桨叶2的跟随偏差太大', '桨叶2PMM防雷保护器激活', '桨叶3变桨系统进线电源过压', '桨叶3变桨系统进线电源欠压', '桨叶3变桨系统进线电源相序错误', '桨叶3直流回路PMC侧过压', '桨叶3直流回路PMM升压器侧过压', '桨叶3直流回路PMC侧欠压', '桨叶3PMM与PMC间的直流回路中断', '桨叶3PMM24V电源进线侧过压', '桨叶3PMM24V电源进线侧欠压', '桨叶3斩波器故障', '桨叶3的存储器或PMM硬件故障', '桨叶3PMM程序存储器故障', '桨叶3PMM的看门狗复位故障', '桨叶3PMC程序故障或硬件故障', '桨叶3PMM模数转换器故障', '桨叶3PMM参数错误', '桨叶3PMC电源检测器失效', '桨叶3编码器故障', '桨叶3PMC电机编码器运算故障', '桨叶3电机编码器数据通道故障', '桨叶3桨叶编码器故障', '桨叶3PMM心跳信号或接点监测失效', '桨叶3PMMCANbus通信故障', '桨叶3速度控制器输出频率超出最大转速频率', '桨叶3的跟随偏差太大', '桨叶3PMM防雷保护器激活', '桨叶1PMC心跳信号超时', '机舱急停按钮触发', '急停安全链断开', '振动传感器开关被触发', '急停准备复位', '安全链准备复位', '机舱PLC看门狗信号断开', '机舱柜温度超限', '机舱24VUPS故障', '机舱柜雷电保护器失效', '机舱柜温度高', '机舱柜温度低', '机舱柜温度较高', '机舱柜温度重复故障', '安全链24V反馈异常', '机舱24V反馈异常', '机舱柜24V电压过载', '机舱柜204Q1分闸', '齿轮箱泵加热器222F4分闸', '机舱柜690V刀熔开关动作', '机舱柜偏航电机主保护开关230Q1分闸', '机舱柜齿轮箱水冷风扇224Q1分闸', '机舱柜机舱冷却风扇218Q1分闸', '机舱柜齿轮箱加热器224Q7分闸', '机舱柜风扇210F1分闸', '机舱柜发电机外部风扇226Q1分闸', '机舱柜发电机内部风扇226Q4分闸', '机舱柜发电机加热器226Q5分闸', '机舱柜400V变24V开关电源212F1分闸', '机舱柜航空灯电源236F4开关分闸', '机舱柜液压站油泵开关228Q1分闸', '机舱柜齿轮箱风扇和油泵加热器222F4分闸', '机舱柜液压站加热器开关228F4分闸', '机舱柜24V指示灯供电376ST0电源模块故障', '机舱柜发电机集中润滑开关254F3分闸', '机舱柜偏航电机热继电器保护动作', '机舱柜内部温度点PT100故障', '机舱温度点PT100故障', '机舱齿轮箱油温度点PT100故障', '机舱齿轮箱驱动端轴承温度点PT100故障', '机舱齿轮箱非驱动端轴承温度点PT100故障', '机舱主轴A轴承温度点PT100故障', '690_400V变压器温度点PT100故障', '机舱主轴B轴承温度点PT100故障', '机舱发电机定子U绕组温度点PT100故障', '机舱发电机定子V绕组温度点PT100故障', '机舱发电机定子W绕组温度点PT100故障', '机舱发电机驱动端轴承温度点PT100故障', '机舱发电机非驱动端轴承温度点PT100故障', '机舱发电机冷却空气温度点PT100故障', '机舱户外温度点PT100故障', '机舱柜电磁抱闸开关230F8分闸', '机舱发电机驱动端进风口温度点PT100故障', '机舱发电机中部出风口温度点PT100故障', '机舱发电机非驱动端进风口温度点PT100故障', 'PCH通讯数据无效', '机舱加热器218Q4空开跳闸', '偏航电机加热器空开跳闸', '机舱高速轴刹车电磁阀刹车', '机舱发电机内部冷却风扇启动', '机舱发电机外冷却风扇启动', '机舱发电机空间加热器启动', '机舱发电机冷却器加热器启动', '机舱齿轮箱冷却风扇启动', '机舱齿轮箱低速油泵启动', '机舱齿轮箱高速油泵启动', '机舱齿轮箱油加热器启动', '机舱液压站油泵启动', '机舱液压站加热器启动', '机舱风向风速仪加热器启动', '机舱风扇启动', '机舱顺时针偏航', '机舱逆时针偏航', '机舱偏航电磁刹车动作', '机舱偏航液压压力全释放', '机舱偏航液压压力半释放', '机舱柜加热器启动', '机舱桨叶旁通启动', '机舱加热器启动', '发电机滑环风扇228Q6跳闸', '变桨400V接触器故障', '发电机冷却器加热器故障', '机舱温度高', '机舱温度低', '机舱温度较高', '机舱温度较低', '机舱温度重复性故障', '机舱温度超出最大限制', '机舱温度低于最小限制', '690_400V变压器温度高', '690_400V变压器温度低', '690_400V变压器温度较高', '690_400V变压器温度较低', '690_400V变压器温度重复性故障', '主轴超速等级1', '主轴超速等级2', '发电机超速等级1', '发电机超速等级2', '转速超速等级1重复性故障', '发电机转速编码器失效', '主轴转速编码器失效', '发电机转速超高速', '主轴超速等级3', '发电机超速等级3', '机舱振动X方向超限1', '机舱振动X方向超限2', '机舱振动X方向超限重复性故障', '机舱振动Y方向超限1', '机舱振动Y方向超限2', '机舱振动Y方向超限重复性故障', '主轴转速增长过快', '主轴转速增长过快重复性故障', '主轴轴承A温度高', '主轴轴承A温度低', '主轴轴承A温度较高', '主轴轴承A温度较低', '主轴轴承A温度较高重复性故障', '主轴轴承B温度高', '主轴轴承B温度低', '主轴轴承B温度较高', '主轴轴承B温度较低', '主轴轴承B温度较高重复性故障', '主轴、偏航润滑泵故障', '振动信号保持不变', '发电机转速低于脱网转速', '发电机转速低于刹车转速', '发电机功率设定值与实际功率偏差大', '机舱齿轮箱油位停机', '机舱齿轮箱油压过低停机', '机舱齿轮箱油温高', '机舱齿轮箱油温低', '机舱齿轮箱油温较高', '机舱齿轮箱油温重复性故障', '机舱齿轮箱驱动端轴承温度高', '机舱齿轮箱驱动端轴承温度低', '机舱齿轮箱驱动端轴承温度较低', '机舱齿轮箱驱动端轴承温度重复性故障', '机舱齿轮箱非驱动端轴承温度高', '机舱齿轮箱非驱动端轴承温度低', '机舱齿轮箱非驱动端轴承温度较高', '机舱齿轮箱非驱动端轴承温度较低', '机舱齿轮箱非驱动端轴承温度重复性故障', '不监视机舱齿轮箱油滤芯', '主轴刹车盘磨损停机', '主轴刹车不松开状态', '主轴刹车处于抱闸状态', '主轴允许刹车', '发电机功率10分钟平均值大于额定值', '发电机功率30秒钟平均值大于设定值', '发电机功率1秒钟平均值大于设定值', '发电机功率10分钟平均值重复性故障', '发电机功率1秒钟平均值大于设定值', '发电机碳刷磨损停机', '发电机防雷器保护失效', '发电机转速的瞬间变化过快故障', '发电机转速的瞬间变化过快重复性故障', '发电机U相定子温度高', '发电机U相定子温度低', '发电机U相定子温度较高', '发电机U相定子温度较低', '发电机V相定子温度高', '发电机V相定子温度低', '发电机V相定子温度较高', '发电机V相定子温度较低', '发电机W相定子温度高', '发电机W相定子温度低', '发电机W相定子温度较高', '发电机W相定子温度较低', '发电机定子温度重复性故障', '发电机驱动端轴承温度高', '发电机驱动端轴承温度低', '发电机驱动端轴承温度较高', '发电机非驱动端轴承温度高', '发电机非驱动端轴承温度低', '发电机非驱动端轴承温度较高', '发电机非驱动端轴承温度较低', '发电机轴承温度重复性故障', '发电机冷却空气温度高', '发电机冷却空气温度低', '发电机冷却空气温度较高', '发电机冷却空气温度较低', '发电机冷却空气温度重复性故障', '发电机最大功率30秒平均值重复性故障', '发电机最大功率1秒平均值重复性故障', '液压系统压力过小停机', '液压站油位过低', '液压站油位过低停机', '液压站油位过低重复性故障', '液压站油泵启动时间过长', '液压站油泵启动时间过长重复性故障', '液压站油泵启动时间过短', '液压站油泵启动时间过短重复性故障', '液压站油泵启动次数过多', '偏航电机运转时间过长', '偏航因受阻而停止', '偏航编码器失效', '风机与风向夹角超出限定值', '偏航手动操作', '偏航解缆动作激活', '偏航解缆动作处于准备状态', '台风模式', '风向仪1的信号保持不变', '风向仪2的信号保持不变', '风向仪1和2的信号保持不变', '风向仪1和2失效而且温度低', '风向仪1和2的偏差大停机', '风速仪1的信号保持不变', '风速仪2的信号保持不变', '风速仪1和2的信号保持不变', '风速仪保持不变及温度低', '户外温度超过限制值', '户外温度高', '户外温度低', '户外温度较高', '户外温度较低', '户外温度重复性故障', '风速30秒值过大停机', '不对风速进行检测', '风向仪1屏蔽', '风向仪2屏蔽', '风速仪1屏蔽', '风速超过解缆等级', '风速过大不能进行手动操作模式', '风速过大不能进行自检模式', '机舱柜机组维修或变桨检修模式', '偏航软件手动模式', '机舱柜复位状态代码按钮按下', '机舱柜或塔基柜的快速启动按钮按下', '远程软件或者HMI界面复位安全链按键按下', '安全链没有OK信号(安全链断开)', '塔基PLC看门狗信号断开', '塔基柜温度超限', '塔基柜动力电源供给正常UPS处于电池模式故障', '塔基柜的防雷器保护不正常', '4F5分闸状态', '塔基柜加热器空开10F1分闸状态', '塔基柜24V供电不正常', '通用UPS(12G7/13G1)电池模式', '塔基柜空开7F2分闸状态', '塔基温度PT100失效故障', '塔基柜温度高', '塔基柜温度低', '塔基柜温度较高', '塔基柜温度较低', '塔基柜温度重复性故障', '塔基柜24V开关电源的400V空开12F1分闸状态', '塔基柜温度点PT100失效故障', '塔基柜加热器启动', '塔基温度高', '塔基温度低', '塔基温度较高', '塔基温度较低', '塔基温度高于限定范围', '塔基温度低于限定范围', '塔基温度重复性故障', '电网L1相电压偏高', '电网L2相电压偏高', '电网L3相电压偏高', '电网电压偏高重复性故障', '电网L2相电压偏低', '电网L3相电压偏低', '电网电压偏低重复性故障', '电网频率偏高故障', '电网频率偏低故障', '电网频率重复性故障', '电网三相电压失效', '电网故障恢复', '变频器没有准备控制信号重复性故障', '变频器没有并行信号重复性故障', '变频器内部故障', '变频器Canopen通讯错误', '变频器功率低停机', '变频器功率波动故障', '变频器频繁同步', '变频器低电压穿越激活', '变频器低电压穿越超时', '电网L1相电流高', '电网L2相电流高', '电网L3相电流高', '电网电流高故障重复次数多', '变频器并网柜超温', '变频器控制柜超温', '变频器功率柜超温', 'UPS掉电', '电网相序错误', '电网欠频', '电网超频', '电网交流过压故障', '电网交流欠压故障', '网侧逆变器过流故障', '变频器直流母线过压故障', '变频器直流母线欠压故障', '电网同步失败故障', '发电机转子过流故障', '发电机超速故障', '发电机欠速故障', '并网柜超温', '控制柜超温', '功率柜超温', '网侧逆变器A相驱动故障', '网侧逆变器B相驱动故障', '网侧逆变器C相驱动故障', '转子侧逆变器A相驱动故障', '转子侧逆变器B相驱动故障', '转子侧逆变器C相驱动故障', 'Crowbar导通失败', '转子相序接反故障', '定子相序接反故障', '变频器内部通信故障', '主断路器故障', '网侧逆变器的接触器故障', '充电故障', '有源Crowbar驱动故障', '变频器加热除湿中', '变频器准备就绪', '变频器允许远程参数给定', '变频器允许合闸', '主回路断路器已合闸', '网侧变流器准备工作', '手动控制有功功率', '手动控制无功功率', '手动控制功率因数', '手动控制转距', '机组刹车程序激活', 'EtherCAT任务循环时间超限', '运算中除数为0故障', 'PLC任务主循环时间超限', '100ms任务循环时间超限', '显示状态代码任务循环时间超限', '文件任务循环时间超限', '系统任务循环时间超限重复次数多', '变频器CANbus总线受到干扰重复性故障', '变桨的CANbus通讯故障', 'PLC系统的EtherCAT总线受到干扰', 'PLC系统的EtherCAT总线受到干扰重复性故障', 'PCM51SD卡已满', '系统记录状态代码的缓存故障', 'PCM51内部闪存低可用空间', '变桨的状态代码被屏蔽', '驱动链的状态代码被屏蔽', '齿轮箱的状态代码被屏蔽', '主轴刹车的状态代码被屏蔽', '发电机的状态代码被屏蔽', '液压站的状态代码被屏蔽', '偏航的状态代码被屏蔽', '气候测量仪表的状态代码被屏蔽', '可选器件或者额外附件的状态代码被屏蔽', '手动操作的状态代码被屏蔽', '电网的状态代码被屏蔽', '变频器的状态代码被屏蔽', '控制系统状态的状态代码被屏蔽', '控制柜的状态代码被屏蔽', '箱变的状态代码被屏蔽', '机舱温度控制的状态代码被屏蔽', '塔基温度控制的状态代码被屏蔽', '风速仪结冰', '测试刹车程序30', '测试刹车程序50', '测试刹车程序51', '测试刹车程序100', '测试刹车程序199', '测试刹车程序198', '塔基的机组检修旋钮触发', '旁通偏航到限定位置', '远程复位状态代码', '远程停机', '塔基柜的机组检修模式退出', '远程快速启动', '手动触发数据记录', '塔基柜复位状态代码按钮按下', '机组正常运行', '工厂测试中断运行', '工厂测试中断运行重复性故障', '自检过程中刹车测试失败', '自检过程中变桨系统测试失败', '自检过程中变桨系统的充电电池测试故障', '机组手动操作激活', '刹车程序50超时', '刹车程序51超时', '刹车程序100超时', '刹车程序30超时', '刹车程序200或210超时', '刹车程序199超时', '功率大于停机设定值', '功率大于停机设定值(30秒钟判断)', '电网故障后激活自检程序', 'PLC上电启动后延时结束', '刹车模式激活后延时启动', '工厂测试完成', '机组启动停留在准备并网状态受阻', '立即激活自检程序', '下次启动时需执行自检程序', '激活变桨动作程序', '变桨系统工厂测试程序激活', '偏航系统工厂测试程序激活', '冷却系统工厂测试程序激活', '集中润滑系统工厂测试程序激活', '箱变高压负荷开关合位', '箱变高压负荷开关分位', '箱变高压熔断器熔断', '箱变重瓦斯动作', '箱变温度高停机', '箱变温度低停机', '箱变温度重复性故障', '箱变超高温动作', '箱变压力释放动作', '箱变低压断路器合位', '箱变低压断路器分位', '箱变低压断路器故障', '箱变油位异常', '箱变低压远方控制', '箱变高压远方控制', '充电故障', '有源Crowbar驱动故障', 'Chopper电路驱动故障', '直流母线严重过压', '并网开关故障', '编码器Z脉冲丢失', '编码器Z脉冲或AB脉冲异常', 'Chopper电路连续工作时间长', '电网电流不平衡', '电网过流', '电网电压A相缺相', '电网电压B相缺相', '电网电压C相缺相', '电网电流A相缺相', '电网电流B相缺相', '电网电流C相缺相', '网侧接地故障', '转子侧接地故障', 'RC电阻过温故障', '转子侧电抗器过温故障', '变频器重复性故障', '电网电压异常', '自检充电异常', '自检Chopper异常', 'LVRT失败', 'LVRT超时', '变频器外部通讯故障', '接触器/断路器断不开导致开CrowBar', '轴控箱1PMC散热片温度高（4210）', '轴控箱2PMC散热片温度高（4210）', '轴控箱3PMC散热片温度高（4210）', '轴控箱1PMM24V馈入过流(2210)', '轴控箱1PMM充电器短路(2250)', '轴控箱1PMM升压器短路（2260）', '轴控箱1温度传感器1短路（4190）', '轴控箱1温度传感器2短路（4191）', '轴控箱1温度传感器硬件未连接（4280）', '轴控箱1温度传感器硬件短路（4290）', '轴控箱1电池模组1电压低（3281）', '轴控箱1电池模组2电压低（3282）', '轴控箱1电池模组3电压低（3283）', '轴控箱1电池模组4电压低（3284）', '轴控箱1电池模组5电压低（3285）', '轴控箱1电池模组6电压低（3286）', '轴控箱1电池模组7电压低（3287）', '轴控箱1电池模组8电压低（3288）', '轴控箱1PMM内部24V关闭故障(5114)', '轴控箱1PMM24V供电功率极错误(5120)', '轴控箱1PMMRs485接口通信错误（7510）', '轴控箱1PMMCan通信错误（8100）', '轴控箱1PMMCan溢出报文丢失（8110）', '轴控箱1PMMCan通信负极错误（8120）', '轴控箱1PMMCan通信对象PDO未找到（8230）', '轴控箱1PMC运行过程中Enable输入电压低（PMCX4.5)(5441)', 'PMC运行中负限位激活（PMCX4.9）(5442)', '轴控箱1PMC特定位置未检测到接近开关信号(5444)', '轴控箱1PMC撞击挡块时检测到接近开关信号(5445)', '轴控箱1PMC硬件Ram错误（5510）', '轴控箱1PMC硬件Eeprom编程错误（5530）', '轴控箱1PMC看门狗重启（6010）', '轴控箱1PMC参数错误（6320）', '轴控箱1PMCCan通信错误（8100）', '轴控箱1PMCCan溢出报文丢失（8110）', '轴控箱1PMCCan通信负极错误（8120）', '轴控箱1PMCCan通信心跳或节点保护失败（8130）', '轴控箱1PMCCan通信关闭（8140）', '轴控箱1PMCCan通信对象PDO未找到（8230）', '轴控箱1PMC电机编码器与桨叶编码器误差大（8620）', '轴控箱1PMC位置小于最小极限值（86F1)', '轴控箱1PMC位置大于最大极限值（86F2)', '轴控箱1PMM用户自定义输入故障激活(FFFn)', '轴控箱2PMM24V馈入过流(2210)', '轴控箱2PMM充电器短路(2250)', '轴控箱2PMM升压器短路（2260）', '轴控箱2温度传感器1短路（4190）', '轴控箱2温度传感器2短路（4191）', '轴控箱2温度传感器硬件未连接（4280）', '轴控箱2温度传感器硬件短路（4290）', '轴控箱2电池模组1电压低（3281）', '轴控箱2电池模组2电压低（3282）', '轴控箱2电池模组3电压低（3283）', '轴控箱2电池模组4电压低（3284）', '轴控箱2电池模组5电压低（3285）', '轴控箱2电池模组6电压低（3286）', '轴控箱2电池模组7电压低（3287）', '轴控箱2电池模组8电压低（3288）', '轴控箱2PMM内部24V关闭故障(5114)', '轴控箱2PMM24V供电功率极错误(5120)', '轴控箱2PMMRs485接口通信错误（7510）', '轴控箱2PMMCan通信错误（8100）', '轴控箱2PMMCan溢出报文丢失（8110）', '轴控箱2PMMCan通信负极错误（8120）', '轴控箱2PMMCan通信对象PDO未找到（8230）', '轴控箱2PMC运行过程中Enable输入电压低（PMCX4.5）(5441)', 'PMC运行中负限位激活（PMCX4.9）(5442)', '轴控箱2PMC特定位置未检测到接近开关信号(5444)', '轴控箱2PMC撞击挡块时检测到接近开关信号(5445)', '轴控箱2PMC硬件Ram错误（5510）', '轴控箱2PMC硬件Eeprom编程错误（5530）', '轴控箱2PMC看门狗重启（6010）', '轴控箱2PMC参数错误（6320）', '轴控箱2PMCCan通信错误（8100）', '轴控箱2PMCCan溢出报文丢失（8110）', '轴控箱2PMCCan通信负极错误（8120）', '轴控箱2PMCCan通信心跳或节点保护失败（8130）', '轴控箱2PMCCan通信关闭（8140）', '轴控箱2PMCCan通信对象PDO未找到（8230）', '轴控箱2PMC电机编码器与桨叶编码器误差大（8620）', '轴控箱2PMC位置小于最小极限值（86F1)', '轴控箱2PMC位置大于最大极限值（86F2)', '轴控箱2PMM用户自定义输入故障激活(FFFn)', '轴控箱3PMM24V馈入过流(2210)', '轴控箱3PMM充电器短路(2250)', '轴控箱3PMM升压器短路（2260）', '轴控箱3温度传感器1短路（4190）', '轴控箱3温度传感器2短路（4191）', '轴控箱3温度传感器硬件未连接（4280）', '轴控箱3温度传感器硬件短路（4290）', '轴控箱3电池模组1电压低（3281）', '轴控箱3电池模组2电压低（3282）', '轴控箱3电池模组3电压低（3283）', '轴控箱3电池模组4电压低（3284）', '轴控箱3电池模组5电压低（3285）', '轴控箱3电池模组6电压低（3286）', '轴控箱3电池模组7电压低（3287）', '轴控箱3电池模组8电压低（3288）', '轴控箱3PMM内部24V关闭故障(5114)', '轴控箱3PMM24V供电功率极错误(5120)', '轴控箱3PMMRs485接口通信错误（7510）', '轴控箱3PMMCan通信错误（8100）', '轴控箱3PMMCan溢出报文丢失（8110）', '轴控箱3PMMCan通信负极错误（8120）', '轴控箱3PMMCan通信对象PDO未找到（8230）', '轴控箱3PMC运行过程中Enable输入电压低（PMCX4.5）(5441)', 'PMC运行中负限位激活（PMCX4.9）(5442)', '轴控箱3PMC特定位置未检测到接近开关信号(5444)', '轴控箱3PMC硬件Ram错误（5510）', '轴控箱3PMC硬件Eeprom编程错误（5530）', '轴控箱3PMC看门狗重启（6010）', '轴控箱3PMC参数错误（6320）', '轴控箱3PMCCan通信错误（8100）', '轴控箱3PMCCan溢出报文丢失（8110）', '轴控箱3PMCCan通信负极错误（8120）', '轴控箱3PMCCan通信心跳或节点保护失败（8130）', '轴控箱3PMCCan通信关闭（8140）', '轴控箱3PMCCan通信对象PDO未找到（8230）', '轴控箱3PMC电机编码器与桨叶编码器误差大（8620）', '轴控箱3PMC位置小于最小极限值（86F1)', '轴控箱3PMC位置大于最大极限值（86F2)', '轴控箱3PMM用户自定义输入故障激活(FFFn)', '机舱消防开启', '机舱自动消防230V空开分闸', '塔基柜消防开启', '塔基自动消防230V空开分闸'

])

#故障部位，系统
fsyst = pd.Series([])

fault = pd.DataFrame({'fname':fname,'fnum':fnum.astype(int),'fsyst':fsyst})
fault['fsyst'] = fault['fname']

#故障索引号， 故障码（状态码）
snum = pd.Series([])

#故障组织，厂家风机状态
sname_org = pd.Series([])

#故障码原因，监控状态
sname = pd.Series([
    '正常发电', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '计划停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '环境待命', '环境待命', '环境待命', '环境待命', '环境待命', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '用户停机', '用户停机', '用户停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '电网故障', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '用户停机', '用户停机', '用户停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '用户停机', '故障停机', '用户停机', '用户停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '用户停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '计划停机', '计划停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '电网故障', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机', '故障停机'
])

state = pd.DataFrame({'type_org':sname_org,'snum':snum.astype(int),'state_type':sname})

# 并网转速
Rotspd_Connect = 1074.2 
# 额定转速
Rotspd_Rate = 1755.0 
# 转矩控制系数
# 清洗数据时使用的测点是转速还是叶片转速(简写)
clear_rotspd = "rotspd"

# 最小桨距角
Pitch_Min = -0.5

# 并网状态
state_ = 3
#限功率状态
limpw_state = 80 #统一状态替换
#正常发电状态
stateNormal = 71

# # 合计风速
wspd = pd.Series([
    0, 0.5, 1, 1.5, 2, 2.5, 
    3. , 3.5, 4. , 4.5, 5. , 5.5, 6. , 6.5, 7. , 7.5, 8. , 8.5, 9. ,9.5,10. ,10.5,11. ,
    11.5,12. ,12.5,13. ,13.5,14. ,14.5, 15., 15.5, 16., 16.5,17. ,17.5,18. ,18.5,19. ,19.5,20. ,20.5,21. ,21.5,22. ,22.5,23. ,23.5,24. ,24.5,25. ])
# # 合计功率
pwrat = pd.Series([
    0,0,0,0,0,0,
    15,62.5,109.6, 185.2, 261.2, 370.8, 480.3, 629.5, 778.4, 972.8, 1167.6, 1402.0, 1637.1, 1818.7, 2000.1, 2000.7, 2000.9, 
    2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0
])